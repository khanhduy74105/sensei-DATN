generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

model User {
  id                 String              @id @default(uuid())
  clerkUserId        String              @unique
  email              String              @unique
  name               String?
  imageUrl           String?
  industry           String?
  createdAt          DateTime            @default(now())
  updatedAt          DateTime            @updatedAt
  bio                String?
  experience         Int?
  skills             String[]
  assessments        Assessment[]
  coverLetter        CoverLetter[]
  liveMockInterviews LiveMockInterview[]
  resume             Resume[]
  industryInsight    IndustryInsight?    @relation(fields: [industry], references: [industry], onDelete: Cascade)
  UserCredit         UserCredit?
}

model Assessment {
  id             String   @id @default(cuid())
  userId         String
  quizScore      Float
  questions      Json[]
  category       String
  improvementTip String?
  createdAt      DateTime @default(now())
  updatedAt      DateTime @updatedAt
  user           User     @relation(fields: [userId], references: [id], onDelete: Cascade)

  @@index([userId])
}

model Resume {
  id                   String              @id @default(cuid())
  userId               String
  content              String
  title                String?
  atsScore             Float?
  feedback             String?
  isPublic             Boolean             @default(false)
  createdAt            DateTime            @default(now())
  updatedAt            DateTime            @updatedAt
  json                 String?
  template             String?             @default("classic")
  accentColor          String?             @default("neutral")
  professional_summary String?
  skills               String[]
  user                 User                @relation(fields: [userId], references: [id], onDelete: Cascade)
  educations           ResumeEducation[]
  experiences          ResumeExperience[]
  personalInfo         ResumePersonalInfo?
  projects             ResumeProject[]
}

model ResumePersonalInfo {
  id         String  @id @default(cuid())
  resumeId   String  @unique
  image      String?
  fullName   String?
  profession String?
  phone      String?
  email      String?
  location   String?
  linkedin   String?
  website    String?
  resume     Resume  @relation(fields: [resumeId], references: [id], onDelete: Cascade)
}

model ResumeExperience {
  id           String   @id @default(cuid())
  resumeId     String
  title        String
  organization String
  description  String
  startDate    String
  endDate      String?
  isCurrent    Boolean?
  resume       Resume   @relation(fields: [resumeId], references: [id], onDelete: Cascade)
}

model ResumeEducation {
  id             String  @id @default(cuid())
  resumeId       String
  graduationDate String
  institution    String
  degree         String
  field          String
  gpa            String?
  resume         Resume  @relation(fields: [resumeId], references: [id], onDelete: Cascade)
}

model ResumeProject {
  id          String @id @default(cuid())
  resumeId    String
  name        String
  description String
  type        String
  resume      Resume @relation(fields: [resumeId], references: [id], onDelete: Cascade)
}

model CoverLetter {
  id             String   @id @default(cuid())
  userId         String
  content        String
  recipient      String?
  description    String
  companyName    String?
  title          String
  type           String   @default("application")
  status         String   @default("draft")
  createdAt      DateTime @default(now())
  updatedAt      DateTime @updatedAt
  user           User     @relation(fields: [userId], references: [id], onDelete: Cascade)

  @@index([userId])
}

model IndustryInsight {
  id                String   @id @default(cuid())
  industry          String   @unique
  salaryRanges      Json[]
  growthRate        Float
  demandLevel       String
  topSkills         String[]
  marketOutlook     String
  keyTrends         String[]
  recommendedSkills String[]
  lastUpdated       DateTime @default(now())
  nextUpdate        DateTime
  users             User[]

  @@index([industry])
}

model LiveMockInterview {
  id                    String                  @id @default(cuid())
  userId                String
  yoes                  Int                     @default(0)
  role                  String
  description           String
  createdAt             DateTime                @default(now())
  updatedAt             DateTime                @updatedAt
  LiveInterviewQuestion LiveInterviewQuestion[]
  user                  User                    @relation(fields: [userId], references: [id], onDelete: Cascade)

  @@index([userId])
}

model LiveInterviewQuestion {
  id                  String            @id @default(cuid())
  liveMockInterviewId String
  question            String
  correctAnswer       String
  feedback            String?
  rating              Int?
  userAnswer          String?
  createdAt           DateTime          @default(now())
  updatedAt           DateTime          @updatedAt
  liveMockInterview   LiveMockInterview @relation(fields: [liveMockInterviewId], references: [id], onDelete: Cascade)

  @@index([liveMockInterviewId])
}

model UserCredit {
  id        String   @id @default(dbgenerated("encode(gen_random_bytes(12), 'hex'::text)"))
  userId    String   @unique
  balance   Int      @default(10)
  createdAt DateTime @default(now())
  updatedAt DateTime @default(now())
  isPaid    Boolean? @default(false)
  metadata  Json?
  User      User     @relation(fields: [userId], references: [id])
}
